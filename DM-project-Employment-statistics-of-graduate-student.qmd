---
title: "DM-project-Employment-statistics-of-graduate-student"
author: "Lou Delattre  Yufeng Jiang"
format: html
---

```{r}
#| message: false
here::i_am("DM-project-Employment-statistics-of-graduate-student.Rproj")
library(here)
library(vroom)
library(ggplot2)
library(dplyr)
theme_set(theme_bw())
```

## Data import


We aim to analyze the employability, situation of employment and salary of graduate students, depending on their graduate program and university.

Here, we are using employment statistics of master student from the survey made by the Ministère de l'Enseignement Supérieur et de la Recherche. To focus on a more targeted subset, we import the data where the 'académie' value is Paris.

### Main dataset: Employment survey of master students data
```{r}
#| message: false
insersion_master <- vroom(here("data", "fr-esr-insertion_professionnelle-master.csv"))
```

|                        |                            |
|------------------------|----------------------------|
| Number of observations | `r NROW(insersion_master)` |
| Number of variables    | `r NCOL(insersion_master)` |

**Source:** <u>https://data.enseignementsup-recherche.gouv.fr/explore/embed/dataset/fr-esr-insertion_professionnelle-master/table/?disjunctive.numero_de_l_etablissement&disjunctive.academie&sort=-salaire_net_median_des_emplois_a_temps_plein&refine.academie=Paris</u>

In this dataset, each observation includes: 

-   The university, the field and subject of the graduate program; <br>
-   The number of responses and response rate;<br>
-   The percentage of women and scholarship students; <br>
-   The "insertion" rate (% of the graduates that are employed)<br>
-   The percentage of students that work full-time, in executive positions, and outside the Île-de-France region;<br>
-   The median monthly net salary and the estimated gross annual salary of graduates that work full time;<br>
-   The unemployment rate for the graduates that stayed in the ÎIe-de-France region; <br>
-   First and third quartile net monthly salaries for graduates that stayed in the Île-de-France region. <br>


### Complemantary dataset: wages data

For comparison purposes, we also have 2018 data on median/average salaries in the Île-de-France region and at national level, taking into account multiple variables such as sector, type of position and gender. We estimate there are enough sectors included in the file to classify all graduate programs. 

The data was collected by the Insee from two databases (Tous Salariés and Flores).<br>

**Source:** <u>https://www.insee.fr/fr/statistiques/5650198</u>

This dataset is presented in several tables. We simply split the file by each table and removed some textual explanatory information to import the file into R.

```{r}
#| message: false
Net_wage_EQTP <- vroom(here("data", "Figure_1_Distribution_of_Monthly_Net_Wages_in_Ile-de-France_and_France_EQTP.csv"))
```

|                        |                         |
|------------------------|-------------------------|
| Number of observations | `r NROW(Net_wage_EQTP)` |
| Number of variables    | `r NCOL(Net_wage_EQTP)` |

```{r}
#| message: false
pct_high_income <- vroom(here("data", "Figure_2_Ile-de-France_Share_in_High_Incomes_High_Wealth_and_High_Wages.csv"))
```

|                        |                           |
|------------------------|---------------------------|
| Number of observations | `r NROW(pct_high_income)` |
| Number of variables    | `r NCOL(pct_high_income)` |

```{r}
#| message: false
wages_profession_gender <- vroom(here("data", "Figure_4_Average_Monthly_Net_Wages_EQTP_by_Socio-Professional_Category_and_Gender.csv"))
```
|                        |                                   |
|------------------------|-----------------------------------|
| Number of observations | `r NROW(wages_profession_gender)` |
| Number of variables    | `r NCOL(wages_profession_gender)` |

```{r}
#| message: false
wages_industry_loc <- vroom(here("data", "Figure_5_Average_and_Median_Monthly_Net_Wages_by_Industry.csv"))
```
|                        |                              |
|------------------------|------------------------------|
| Number of observations | `r NROW(wages_industry_loc)` |
| Number of variables    | `r NCOL(wages_industry_loc)` |

```{r}
#| message: false
wages_employment_zone <- vroom(here("data", "Figure_6_Average_Monthly_Net_Wages_EQTP_in_Ile-de-France_by_Employment_Zone_and_EPT.csv"))
```
|                        |                                 |
|------------------------|---------------------------------|
| Number of observations | `r NROW(wages_employment_zone)` |
| Number of variables    | `r NCOL(wages_employment_zone)` |


## Data Cleaning

In our main dataset, there are 35 variables. Some of them might be superfluous or at least not relevant for our analysis.

-   The "Académie"(the 7th column) and "Code de l'académie"(the 6th column) is redundant, as all universities in the sample belong to the same "Académie". Thus, all observations have "A01" as "Code de l'académie" and are managed by the "Académie" of Paris.

-   "Etablissement actuel"(the 5th column) is not relevant.

-   "cle_ETAB"(the 33th column) could be obtained using more explicit columns. It is redundant.

-   "Id_Paysage"(the 35th column) is redundant. It has the same purpose as "Code de l'établissement".

-   "Taux d'emploi"(the 18th column) and "Taux d'emploi en France"(the 19th column) are missing a significant amount of values(1155 out of 1265 observations). We consider that "Taux d'insertion" is sufficient, as the difference between the employment rate and insertion rate may not be significant. According to the original source, the employment rate is computed including inactives (neither working nor in search of employment.) while the insertion rate does not include them.

Therefore, we can delete the 5th, 6th, 7th, 18th, 19th, 33th and 35th columns in the original dataset.

```{r}
insersion_master <- insersion_master |> select(-c(5, 6, 7, 18, 19, 33, 35))
```

However, some graduate programs have two observations (one after 18 months, one after 30 months). To perfectly identify each observation of each master program, we have to create another variable (or primary key).

-    The identifier is called "obs_ID" and is made of the concatenation of "Annee", "Numéro de l'établissement" and "cle_disc". We can then check that there are 1265 unique values in our newly made column.

```{r}
insersion_master <- insersion_master |>
  mutate(obs_ID = paste(Annee,  `Numéro de l'établissement`, `cle_DISC`, sep = "_"))
```







